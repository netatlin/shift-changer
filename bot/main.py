import telebot
from telebot import types
import random
import logging
from json_formatter import JSONFormatter
from config import TOKEN


logger = logging.getLogger(__name__)
logger.setLevel(logging.DEBUG)
loggingStreamHandler = logging.StreamHandler()
loggingStreamHandler.setFormatter(JSONFormatter())
logger.addHandler(loggingStreamHandler)
logger.info({"message": 'Bot is starting'})

bot = telebot.TeleBot(TOKEN)
channel_id = -1001639740273

random_message = lambda message: random.choice(message)

random_filling_message = lambda filling, message: random.choice(message) % filling

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
first_message = ['–ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –±–æ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞–º–µ–Ω –≤ –Ω–∞—à–µ–π –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–π –ö—É—Ö–Ω–µ –Ω–∞ –†–∞–π–æ–Ω–µ. –ü—Ä–æ—á–∏—Ç–∞–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ, '
                  '–∫–∞–∫ –º–Ω–æ—é –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, —á—Ç–æ–±—ã –≤—Å–µ–º –±—ã–ª–æ —É–¥–æ–±–Ω–æ.\n\n–ï—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å–µ–±–µ –∑–∞–º–µ–Ω—É, –Ω–∞–ø–∏—à–∏ –º–Ω–µ '
                  '–ø–æ–¥—Ä–æ–±–Ω–æ, –Ω–∞ –∫–∞–∫–æ–µ —á–∏—Å–ª–æ –∏—â–µ—à—å, –Ω–∞ –∫–∞–∫–æ–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –∏ —Å –∫–∞–∫–æ–≥–æ –ø–æ –∫–∞–∫–æ–π —á–∞—Å. –ò –¥–æ–±–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, '
                  '–µ—Å–ª–∏ –Ω—É–∂–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä: \n\n<i>¬´–í—Å–µ–º —Ö–∞–π! –ò—â—É –≥–µ—Ä–æ—è –Ω–∞ 12 –º–∞—è, —Å—Ä–µ–¥–∞, —Å 12:00 –¥–æ 17:00. '
                  '–£ –º–µ–Ω—è —ç–∫–∑ ‚Äî –º–æ–≥—É –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø–æ—Ä–∞–Ω—å—à–µ, –∏ —Ç–æ–≥–¥–∞ —Ç—ã–∫–Ω—É, –∫–∞–∫ –∑–∞–±–µ—Ä—É —Å–º–µ–Ω—É –æ–±—Ä–∞—Ç–Ω–æ üôåüèª‚Äé¬ª</i> '
                  '\n\n–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–µ —Ç–∞–∫, –∏–ª–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –æ—Ç–æ–∑–≤–∞—Ç—å —Ç–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤—Å–µ–≥–¥–∞ –ø–æ –≤—Å–µ–º '
                 '–≤–æ–ø—Ä–æ—Å–∞–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –∏ –∫–∞–Ω–∞–ª–∞ –ø–∏—à–∏ –Ø–Ω–µ: @lilgorchitca'
                 ]

# –°–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
reply_message = ['–ì–æ—Ç–æ–≤–æ, –∏—â–∏ —Å–µ–±—è –≤ –∫–∞–Ω–∞–ª–µ –∑–∞–º–µ–Ω! –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ç–≤–æ–π —Å–ø–∞—Å–∏—Ç–µ–ª—å –Ω–∞–π–¥—ë—Ç—Å—è, –Ω–∞–ø–∏—à—É —Ç–µ–±–µ. '
                 '–ü–æ—ç—Ç–æ–º—É —Å–æ–≤–µ—Ç—É—é –º–µ–Ω—è –Ω–µ –º—å—é—Ç–∏—Ç—å ;)',
                 '–°—É–ø–µ—Ä! –£–∂–µ –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª. –ù–∞–ø–∏—à—É, –µ—Å–ª–∏ –Ω–∞–π–¥—ë—Ç—Å—è —á–µ–ª–æ–≤–µ–∫ –Ω–∞ –∑–∞–º–µ–Ω—É. –ù–µ –º—å—é—Ç—å –º–µ–Ω—è!',
                 '–û–≥–æ! –°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –ø–µ—Ä–µ—Å–ª–∞–Ω–æ –≤ –∫–∞–Ω–∞–ª. –ñ–¥–∏, –∫–æ–≥–¥–∞ —Ç–µ–±–µ –ø—Ä–∏–¥—É—Ç –Ω–∞ –ø–æ–¥–º–æ–≥—É. –£–≤–µ—Ä–µ–Ω, —ç—Ç–æ '
                 '–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–ª—É—á–∏—Ç—Å—è! –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∫—Ç–æ-—Ç–æ –æ—Ç–∫–ª–∏–∫–Ω–µ—Ç—Å—è ‚Äì —è —Ç–µ–±–µ —Å–æ–æ–±—â—É',
                 '–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ª–∏—á–Ω–æ–µ, —É —Ç–µ–±—è –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤—ã–π –ø–æ—á–µ—Ä–∫. –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª –µ–≥–æ –≤ –∫–∞–Ω–∞–ª –∑–∞–º–µ–Ω, —Ç–∞–º –∏–º —Ç–æ–∂–µ '
                 '–ª—é–±–æ–≤–∞—Ç—å—Å—è –±—É–¥—É—Ç. –ê –∫–æ–º—É-—Ç–æ —Ç–∞–∫ –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è, —á—Ç–æ –æ–Ω –¥–∞–∂–µ –≤—ã–π–¥–µ—Ç –∑–∞ —Ç–µ–±—è! (–Ω–∞ —Å–º–µ–Ω—É) \n\n(–∏–∑–≤–∏–Ω—è—é—Å—å –∑–∞ '
                 '—à—É—Ç–∫—É, —è –∫–æ–≥–¥–∞ —ç—Ç–æ –ø–∏—Å–∞–ª, –±—ã–ª –≤ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏)',
                 '–ë–ª–∏–Ω, —ç—Ç–æ –∂–µ –Ω–∞–¥–æ —Ç–∞–∫! –¢–∞–∫ –∫—Ä–∞—Å–∏–≤–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –º—ã—Å–ª–∏! –¢—ã –Ω–µ –∫–Ω–∏–≥–∏ —Å–ª—É—á–∞–π–Ω–æ –ø–∏—à–µ—à—å? –í –ª—é–±–æ–º '
                 '—Å–ª—É—á–∞–µ, —Å–ø–∞—Å–∏–±–æ. –í–æ–æ–±—â–µ, —Ç–∞–∫–∏–µ –ª—é–¥–∏ –∫–∞–∫ —Ç—ã –ø–æ–º–æ–≥–∞—é—Ç –º–Ω–µ –æ—Å–æ–∑–Ω–∞–≤–∞—Ç—å, —á—Ç–æ —Ç–æ, —á—Ç–æ —è –¥–µ–ª–∞—é ‚Äì '
                 '–≤–∞–∂–Ω–æ. –í–æ—Ç, —É–∂–µ –ø–µ—Ä–µ—Å–ª–∞–ª —Ç–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª. –û—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞–¥–µ—è—Ç—å—Å—è –∏ –∂–¥–∞—Ç—å, —á—Ç–æ '
                 '—Ç–µ–±–µ –∫—Ç–æ-—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç. –Ø –Ω–∞–ø–∏—à—É —Ç–µ–±–µ! –ö–∞–∫ —Ç–æ–ª—å–∫–æ ‚Äì —Ç–∞–∫ —Å—Ä–∞–∑—É! –û–±–µ—â–∞—é!']

# –ù–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –≥–µ—Ä–æ—è
hero_nick = ['–ì–µ—Ä–æ–π', '–°–ø–∞—Å–∏—Ç–µ–ª—å', '–õ—É—á—à–∏–π —á–µ–ª–æ–≤–µ–∫ –Ω–∞ –∑–µ–º–ª–µ', '–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–µ–π—à–∏–π —á–µ–ª–æ–≤–µ–∫', '–õ—É—á—à–∏–º –≤ —ç—Ç–æ—Ç —Ä–∞–∑ –æ–∫–∞–∑–∞–ª—Å—è',
             '–ò–¥–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫', '–î–æ—Ä–æ–≥–æ–π –Ω–∞—à —á–µ–ª–æ–≤–µ—á–µ–∫', '–ó–æ–ª–æ—Ç—Ü–µ –∫—É—Ö–Ω–∏']

# –ù–∞–¥–ø–∏—Å–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
buttons = ['–ó–∞–±–∏—Ä–∞—é', '–í—ã–π—Ç–∏ –Ω–∞ —Å–º–µ–Ω—É', '–°—Ç–∞—Ç—å –≥–µ—Ä–æ–µ–º', '–ü–æ–º–æ—á—å –Ω—É–∂–¥–∞—é—â–µ–º—É—Å—è', '–°–ø–∞—Å—Ç–∏ —Å–∏—Ç—É–∞—Ü–∏—é']

# –ù–∞—á–∞–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É
after_button_message_top = ['–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫-—Ç–æ —Ä–∞–∑ –æ—Ç —Ç–µ–±—è –ø—Ä–∏—à–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ', '–û–≥–æ! –û–¥–Ω–∞–∂–¥—ã —Ç—ã –Ω–∞–ø–∏—Å–∞–ª –º–Ω–µ',
                            '–î–æ —Å–∏—Ö –ø–æ—Ä –≤—Å–ø–æ–º–∏–Ω–∞—é —Ç–≤–æ—ë –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ö–∞–∫ —Ç–∞–º –±—ã–ª–æ? –ß—Ç–æ —Ç–æ –≤—Ä–æ–¥–µ',
                            '–ü–æ–º–Ω–∏—à—å –º–µ–Ω—è? –Ø –±–æ—Ç! –¢–æ—Ç —Å–∞–º—ã–π, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ –∑–∞–º–µ–Ω—É. –¢–∞–∫ –≤–æ—Ç, —Ç—ã –ø–∏—Å–∞–ª',
                            '–Ø –∂–µ –æ–±–µ—â–∞–ª —Ç–µ–±–µ, —á—Ç–æ –Ω–∞–ø–∏—à—É! –í–æ—Ç ‚Äì –ø–∏—à—É! –ù–µ –ø–æ–º–Ω–∏—à—å? –ù—É –ø–æ–≥–æ–¥–∏, —Ç—ã –∂–µ –ø–∏—Å–∞–ª –º–Ω–µ']
# –ö–æ–Ω–µ—Ü —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É
after_button_message_bottom = ['–•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏! –¢–µ–±–µ –ø–æ–º–æ–∂–µ—Ç @%s! –°–∫–æ—Ä–µ–µ —Å–ø–∏—à–∏—Å—å —Å –Ω–∏–º, –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ –∏ '
                               '–Ω–µ –∑–∞–±—É–¥—å –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å —Å–≤–æ–µ–≥–æ –ª–∏–¥–µ—Ä–∞. –ù—É–∂–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –µ–≥–æ —Ç–≥ –Ω–∏–∂–µ, '
                               '—á—Ç–æ–±—ã —Ç–µ–±–µ –¥–æ–ª–≥–æ –Ω–µ —Ö–æ–¥–∏—Ç—å',
                               '–í –æ–±—â–µ–º. –ù–µ–∫—Ç–æ @%s –≤—ã–∑–≤–∞–ª—Å—è —Ç–µ–±–µ –ø–æ–º–æ—á—å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å! '
                               '–ü–∏—à–∏ –µ–º—É, —Å–∫–∞–∂–∏ —Ç–∞–º "—Å–ø–∞—Å–∏–±–æ" –∏ –≤—Å—ë —Ç–∞–∫–æ–µ. –ê —Ç–∞–∫–∂–µ –Ω–µ –∑–∞–±—É–¥—å –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å '
                               '—Å–≤–æ–µ–≥–æ –ª–∏–¥–µ—Ä–∞. –ù—É–∂–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –µ–≥–æ —Ç–≥ –Ω–∏–∂–µ, '
                               '—á—Ç–æ–±—ã —Ç–µ–±–µ –¥–æ–ª–≥–æ –Ω–µ —Ö–æ–¥–∏—Ç—å',
                               '–¢–∞–∫ –≤–æ—Ç! –ó–∞–º–µ–Ω–∞ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –Ω–∞–π–¥–µ–Ω–∞. –õ—É—á—à–∏–º —á–µ–ª–æ–≤–µ–∫–æ–º –æ–∫–∞–∑–∞–ª—Å—è @%s. –ö—Ä—É—Ç–æ, –¥–∞? '
                               '–°–≤—è–∂–∏—Å—å —Å –Ω–∏–º, –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤—å —Å—Ç–∏–∫–µ—Ä (—è —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é, –±–µ–∑ —Å—Ç–∏–∫–µ—Ä–∞ '
                               '–±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–∂–µ—à—å –∑–∞–º–µ–Ω—ã –∏—Å–∫–∞—Ç—å). –ê –µ—â—ë –Ω–µ –∑–∞–±—É–¥—å –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å '
                               '—Å–≤–æ–µ–≥–æ –ª–∏–¥–µ—Ä–∞. –ù—É–∂–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –µ–≥–æ —Ç–≥ –Ω–∏–∂–µ '
                               ]

# –°–ø–∏—Å–æ–∫ –ª–∏–¥–µ—Ä–æ–≤
leaders = '@lilgorchitca\n@ravenkroft\n@laterdi'

@bot.message_handler(commands=['start'])
def start_message(message):
    """–õ–æ–≥–∏–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞"""
    reply_text = random_message(first_message)
    bot.send_message(message.chat.id, reply_text, parse_mode="HTML")


@bot.message_handler()
def my_orders_message(message):
    """–õ–æ–≥–∏–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –±–æ—Ç–∞"""
    keyboard = types.InlineKeyboardMarkup()
    button_text = random_message(buttons)
    callback_button = types.InlineKeyboardButton(text=button_text, callback_data=message.chat.id)
    keyboard.add(callback_button)
    reply_text = random_message(reply_message)

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª
    bot.copy_message(channel_id, message.chat.id, message.id, reply_markup=keyboard)

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç–∫—É –∞–≤—Ç–æ—Ä—É —Å–æ–æ–±—â–µ–Ω–∏—è
    bot.send_message(message.chat.id, reply_text, reply_to_message_id=message.id)


@bot.callback_query_handler(func=lambda call: True)
def callback_inline(call):
    """–õ–æ–≥–∏–∫–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É"""
    if call.message:
        hero = call.from_user.username
        hero_nickname = random_message(hero_nick)
        new_text = call.message.text + f'\n\n<b>{hero_nickname}: @{hero}</b>'

        # –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
        bot.edit_message_text(chat_id=channel_id, message_id=call.message.message_id, text=new_text, parse_mode="HTML")

        after_top = random_message(after_button_message_top)
        after_bottom = random_filling_message(hero, after_button_message_bottom)
        after_text = f'{after_top}: \n\n<i>{call.message.text}</i>\n\n{after_bottom}\n\n{leaders}'

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä—É —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
        bot.send_message(call.data, text=after_text, parse_mode="HTML")


bot.polling(none_stop=True)
